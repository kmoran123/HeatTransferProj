
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>HotDogCode_KatyAnnaHayley</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-04-01"><meta name="DC.source" content="HotDogCode_KatyAnnaHayley.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput">clear
clc
close <span class="string">all</span>
format <span class="string">compact</span>

<span class="comment">% Transport 3 Hot Dog Project Code</span>
<span class="comment">% for Katy Moran, Anna Hartig, and Hayley Semple</span>

<span class="comment">% list of material properties and design constraints with units.</span>
densityHotDog = 880;                                <span class="comment">%[kg/m^3]</span>
kHotDog = 0.52;                                     <span class="comment">%[W/m-K]</span>
cHotDog = 3350;                                     <span class="comment">%[K/kg-K]</span>
diameterHotDog = 0.0254;                            <span class="comment">%[m]</span>
radiusHotDog = diameterHotDog/2;                    <span class="comment">%[m]</span>

initialTemp = 15 + 273.15;                          <span class="comment">%[K]</span>
maxTs = 100 + 273.15;                               <span class="comment">%[K]</span>
finalTemp = 60 + 273.15;                            <span class="comment">%[K]</span>
gasTemp = 295 + 273.15;                             <span class="comment">%[K]</span>
coalsTemp = 425 + 273.15;                           <span class="comment">%[K]</span>
emissivityCoals = 0.8;
emissivityHotDog = 0.45;
diameterCoals = 0.045;                              <span class="comment">%[m]</span>

deltar = 0.0001; <span class="comment">%**delta r** can be adjusted if needed %[m]</span>
M = radiusHotDog/deltar;
alphaHotDog = kHotDog/(densityHotDog*cHotDog);      <span class="comment">%[m^2/s]</span>

<span class="comment">% calculating velocity of air</span>
beta = 1/((coalsTemp + gasTemp)/2);
velocityAir = sqrt(9.81*beta*(coalsTemp - gasTemp)*diameterCoals);   <span class="comment">%[m/s]</span>

<span class="comment">% % Calculating coefficients, h -------------------------------------------</span>
<span class="comment">% h rad calculation</span>
hRad = 5;                                           <span class="comment">%[W/m^2-K]</span>

<span class="comment">% h convec calculation</span>
<span class="comment">% calculating the air properties</span>
TsurfaceHCalc = (initialTemp + gasTemp)/2;          <span class="comment">%[K]</span>
lowTemp = 400;                                      <span class="comment">%[K]</span>
highTemp = 450;                                     <span class="comment">%[K]</span>
nuLow = 26.41e-6;
nuHigh = 32.39e-6;
kAirLow = 33.8e-3;                                  <span class="comment">%[W/m-K]</span>
kAirHigh = 37.3e-3;                                 <span class="comment">%[W/m-K]</span>
PrLow = 0.690;
PrHigh = 0.686;

<span class="comment">% interpolating the properties of air</span>
nuFilm = nuLow + (TsurfaceHCalc - lowTemp)*(nuHigh-nuLow)/(highTemp-lowTemp);
kAirFilm = kAirLow + (TsurfaceHCalc - lowTemp)*(kAirHigh-kAirLow)/(highTemp-lowTemp);
PrFilm = PrLow + (TsurfaceHCalc - lowTemp)*(PrHigh-PrLow)/(highTemp-lowTemp);

Re = velocityAir*diameterHotDog / nuFilm;
C = 0.683;
mConst = 0.466;

Nu = C*Re^mConst*PrFilm^(1/3);

hConv = Nu*kAirFilm/diameterHotDog;

<span class="comment">%total h</span>
hTot = hRad + hConv;

<span class="comment">% % numerical solution -----------------------------------------------------</span>
<span class="comment">%stability criteria calculation for delta t</span>
deltatSurface = (deltar^2 * M * kHotDog)/(alphaHotDog*(2*M*kHotDog - kHotDog + 2*hTot*M*deltar));
deltatCenter = (deltar^2)/(4*alphaHotDog);
deltatInterior = (deltar^2)/(2*alphaHotDog);

<span class="comment">%choosing the smallest deltat based on stability criteria</span>
<span class="keyword">if</span> (deltatInterior &lt; deltatSurface &amp;&amp; deltatInterior &lt; deltatCenter)
    deltat = deltatInterior;
<span class="keyword">elseif</span> deltatCenter &lt; deltatSurface
    deltat = deltatCenter;
<span class="keyword">else</span>
    deltat = deltatSurface;
    fprintf(<span class="string">'Surface Stability'</span>)
<span class="keyword">end</span>

<span class="comment">%Calculating Fo</span>
Fo = (deltat*alphaHotDog)/deltar^2;

<span class="comment">%initializing the matrices</span>
temperature = zeros(20000, ceil(M)+1);
time=zeros(20000,1);
temperature(1,:) = initialTemp;

<span class="comment">% loop until centerline Temp = 60 degrees</span>
i=1;

<span class="keyword">while</span> temperature(i,1) &lt; finalTemp
    <span class="keyword">for</span> j=1:ceil(M)+1 <span class="comment">%loop through each radial node</span>
        <span class="keyword">if</span> j==1 <span class="comment">%center node</span>
            temperature(i+1,j) = 4*Fo*temperature(i, j+1) - (4*Fo-1)*temperature(i,j);
        <span class="keyword">elseif</span> j==ceil(M)+1 <span class="comment">%surface node</span>
            temperature(i+1, j) = (1 - 2*Fo*(1-(1/(2*M))) - 2*(hTot/kHotDog)*Fo*deltar)*temperature(i,j) + <span class="keyword">...</span>
                2*Fo*(1-(1/(2*M)))*temperature(i, j-1) + 2*(hTot/kHotDog)*Fo*deltar*gasTemp;
        <span class="keyword">else</span> <span class="comment">%all other interior nodes</span>
            temperature(i+1, j) = (1-2*Fo)*temperature(i,j) + Fo*(1-(1/(2*(j-1))))*temperature(i, j-1) + <span class="keyword">...</span>
                Fo*(1+(1/(2*(j-1))))*temperature(i, j+1);
        <span class="keyword">end</span>

    <span class="keyword">end</span>
    time(i+1) = deltat*i;
    i=i+1;

<span class="keyword">end</span>

xmatrix = zeros(128,1); <span class="comment">% creating the radius matrix for each node</span>
<span class="keyword">for</span> k=1:M+1
    xmatrix(k+1) = k*deltar;
<span class="keyword">end</span>

<span class="comment">%Plotting Numerical Solution (Temperature Distribution)</span>
figure
plot(xmatrix, temperature(1,:), xmatrix, temperature(2118,:), xmatrix, temperature(8468,:), xmatrix, temperature(i,:));
title(<span class="string">'Numerical Solution for Temperature Distribution at Specified Times'</span>);
xlabel(<span class="string">'Radius, [m]'</span>)
ylabel(<span class="string">'Temperature, [K]'</span>)
legend(<span class="string">'t = 0 sec'</span>, <span class="string">'t = 30.0044 sec'</span>, <span class="string">'t = 120.0034 seconds'</span>, <span class="string">'t = 333.9319 seconds'</span>);
xlim([0, radiusHotDog])

<span class="comment">% % Analytical solution -----------------------------------------------------</span>

Bi_Tab= [0,       0.01,    0.02,    0.04,    0.06,    0.08,    0.1,     0.15,    0.2,     0.3,     0.4,     0.5];
Table=  [0,       0.1412,  0.1995,  0.2814,  0.3438,  0.396,   0.4417,  0.5376,  0.617,   0.7465,  0.8516,  0.9408; <span class="keyword">...</span>
         3.8317,  3.8343,  3.8369,  3.8421,  3.8473,  3.8525,  3.8577,  3.8706,  3.8835,  3.9091,  3.9344,  3.9594; <span class="keyword">...</span>
         7.0156,  7.017,   7.0184,  7.0213,  7.0241,  7.027,   7.0298,  7.0369,  7.044,   7.0582,  7.0723,  7.0864; <span class="keyword">...</span>
         10.1735, 10.1745, 10.1754, 10.1774, 10.1794, 10.1813, 10.1833, 10.1882, 10.1931, 10.2029, 10.2127, 10.2225;<span class="keyword">...</span>
         13.3237, 13.3244, 13.3252, 13.3267, 13.3282, 13.3297, 13.3312, 13.3349, 13.3387, 13.3462, 13.3537, 13.3611;<span class="keyword">...</span>
         16.4706, 16.4712, 16.4718, 16.4731, 16.4743, 16.4755, 14.4767, 16.4797, 16.4828, 16.4888, 16.4949, 16.501];

p = 1;
theta = zeros(3025, ceil(M)+1);
temp = zeros(3025, ceil(M)+1);
time_a=zeros(3025,1);
temp(1, :) = initialTemp;
Bi = hTot*(radiusHotDog)/kHotDog;

<span class="comment">%interpolating from table!</span>
<span class="keyword">if</span> Bi == 0
    squiggle = Table(:,1);
<span class="keyword">elseif</span> Bi&gt;0 &amp;&amp; Bi&lt;0.01
    squiggle = Table(:,2)-((0.01-Bi)./((0.01-0)./(Table(:,2)-Table(:,1))));
<span class="keyword">elseif</span> Bi == 0.01
    squiggle = Table(:,2);
<span class="keyword">elseif</span> Bi&gt;0.01 &amp;&amp; Bi&lt;0.02
    squiggle = Table(:,3)-((0.02-Bi)./((0.02-0.01)./(Table(:,3)-Table(:,2))));
<span class="keyword">elseif</span> Bi == 0.02
    squiggle = Table(:,3);
<span class="keyword">elseif</span> Bi&gt;0.02 &amp;&amp; Bi&lt;0.04
    squiggle = Table(:,4)-((0.04-Bi)./((0.04-0.02)./(Table(:,4)-Table(:,3))));
<span class="keyword">elseif</span> Bi == 0.04
    squiggle = Table(:,4);
<span class="keyword">elseif</span> Bi&gt;0.04 &amp;&amp; Bi&lt;0.06
    squiggle = Table(:,5)-((0.06-Bi)./((0.06-0.04)./(Table(:,5)-Table(:,4))));
<span class="keyword">elseif</span> Bi == 0.06
    squiggle = Table(:,5);
<span class="keyword">elseif</span> Bi&gt;0.06 &amp;&amp; Bi&lt;0.08
    squiggle = Table(:,6)-((0.08-Bi)./((0.08-0.06)./(Table(:,6)-Table(:,5))));
<span class="keyword">elseif</span> Bi == 0.08
    squiggle = Table(:,6);
<span class="keyword">elseif</span> Bi&gt;0.08 &amp;&amp; Bi&lt;0.1
    squiggle = Table(:,7)-((0.1-Bi)./((0.1-0.08)./(Table(:,7)-Table(:,6))));
<span class="keyword">elseif</span> Bi == 0.1
    squiggle = Table(:,7);
<span class="keyword">elseif</span> Bi&gt;0.1 &amp;&amp; Bi&lt;0.15
    squiggle = Table(:,8)-((0.15-Bi)./((0.15-0.1)./(Table(:,8)-Table(:,7))));
<span class="keyword">elseif</span> Bi == 0.15
    squiggle = Table(:,8);
<span class="keyword">elseif</span> Bi&gt;0.15 &amp;&amp; Bi&lt;0.2
    squiggle = Table(:,9)-((0.2-Bi)./((0.2-0.15)./(Table(:,9)-Table(:,8))));
<span class="keyword">elseif</span> Bi == 0.2
    squiggle = Table(:,9);
<span class="keyword">elseif</span> Bi&gt;0.2 &amp;&amp; Bi&lt;0.3
    squiggle = Table(:,10)-((0.3-Bi)./((0.3-0.2)./(Table(:,10)-Table(:,9))));
<span class="keyword">elseif</span> Bi == 0.3
    squiggle = Table(:,10);
<span class="keyword">elseif</span> Bi&gt;0.3 &amp;&amp; Bi&lt;0.4
    squiggle = Table(:,11)-((0.4-Bi)./((0.4-0.3)./(Table(:,11)-Table(:,10))));
<span class="keyword">elseif</span> Bi == 0.4
    squiggle = Table(:,11);
<span class="keyword">elseif</span> Bi&gt;0.4 &amp;&amp; Bi&lt;0.5
    squiggle = Table(:,12)-((0.5-Bi)./((0.5-0.4)./(Table(:,12)-Table(:,11))));
<span class="keyword">else</span> <span class="comment">%Bi == 0.5</span>
    squiggle = Table(:,12);
<span class="keyword">end</span>

<span class="comment">%determining temp at different times and various positions(vary based on</span>
<span class="comment">%analytical solution)</span>
<span class="keyword">while</span> temp(p,1) &lt; finalTemp
    <span class="keyword">for</span> q=1:ceil(M)+1
        time_a(p+1) = time_a(p) + 0.1;
        <span class="comment">%Calculating Fo</span>
        fo = (time_a(p+1)*alphaHotDog)./(radiusHotDog.^2);

        <span class="comment">%calculating each nth term</span>
        term1 = ((2/squiggle(1)) * besselj(1,squiggle(1)) / <span class="keyword">...</span>
            (((besselj(0,squiggle(1)))^2)+((besselj(1,squiggle(1)))^2)))* <span class="keyword">...</span>
            exp(-(squiggle(1)^2)*fo)*besselj(0,(squiggle(1)*(q-1)*deltar/radiusHotDog));
        term2 = ((2/squiggle(2)) * besselj(1,squiggle(2)) / <span class="keyword">...</span>
            (((besselj(0,squiggle(2)))^2)+((besselj(1,squiggle(2)))^2)))* <span class="keyword">...</span>
            exp(-(squiggle(2)^2)*fo)*besselj(0,(squiggle(2)*(q-1)*deltar/radiusHotDog));
        term3 = ((2/squiggle(3)) * besselj(1,squiggle(3)) / <span class="keyword">...</span>
            (((besselj(0,squiggle(3)))^2)+((besselj(1,squiggle(3)))^2)))* <span class="keyword">...</span>
            exp(-(squiggle(3)^2)*fo)*besselj(0,(squiggle(3)*(q-1)*deltar/radiusHotDog));
        term4 = ((2/squiggle(4)) * besselj(1,squiggle(4)) / <span class="keyword">...</span>
            (((besselj(0,squiggle(4)))^2)+((besselj(1,squiggle(4)))^2)))* <span class="keyword">...</span>
            exp(-(squiggle(4)^2)*fo)*besselj(0,(squiggle(4)*(q-1)*deltar/radiusHotDog));
        term5 = ((2/squiggle(5)) * besselj(1,squiggle(5)) / <span class="keyword">...</span>
            (((besselj(0,squiggle(5)))^2)+((besselj(1,squiggle(5)))^2)))* <span class="keyword">...</span>
            exp(-(squiggle(5)^2)*fo)*besselj(0,(squiggle(5)*(q-1)*deltar/radiusHotDog));
        term6 = ((2/squiggle(6)) * besselj(1,squiggle(6)) / <span class="keyword">...</span>
            (((besselj(0,squiggle(6)))^2)+((besselj(1,squiggle(6)))^2)))* <span class="keyword">...</span>
            exp(-(squiggle(6)^2)*fo)*besselj(0,(squiggle(6)*(q-1)*deltar/radiusHotDog));

        <span class="comment">%summing all the terms</span>
        theta(p+1,q) = term1 + term2 + term3 + term4 + term5 + term6;

        <span class="comment">%calculating temperature</span>
        temp(p+1,q) = theta(p+1,q) .* (initialTemp - gasTemp) + gasTemp;

    <span class="keyword">end</span>

    p=p+1;

<span class="keyword">end</span>

<span class="comment">%Plotting Centerline/Exterior Solution</span>
figure
plot(time_a, temp(:,1), <span class="string">'b'</span> , time_a, temp(:,128), <span class="string">'r'</span>,  time, temperature(:,1), <span class="string">'--b'</span>, time, temperature(:,128), <span class="string">'--r'</span>);
title(<span class="string">'Hot Dog Temperature History'</span>);
xlabel(<span class="string">'time, [seconds]'</span>)
ylabel(<span class="string">'Temperature, [K]'</span>)
legend(<span class="string">'Centerline, Analytical'</span>, <span class="string">'Exterior, Analytical'</span>, <span class="string">'Centerline, Numerical'</span>, <span class="string">'Exterior, Numerical'</span>);
xlim([0, 335])

<span class="comment">%Plotting Analytical Solution (Temperature Distribution)</span>
figure
plot(xmatrix, temp(1,:), xmatrix, temp(301,:), xmatrix, temp(1201,:), xmatrix, temp(p,:));
title(<span class="string">'Analytical Solution for Temperature Distribution at Specified Times'</span>);
xlabel(<span class="string">'Radius, [m]'</span>)
ylabel(<span class="string">'Temperature, [K]'</span>)
legend(<span class="string">'t = 0 sec'</span>, <span class="string">'t = 30 sec'</span>, <span class="string">'t = 120 seconds'</span>, <span class="string">'t = 334.14 seconds'</span>);
xlim([0, radiusHotDog])
</pre><img vspace="5" hspace="5" src="HotDogCode_KatyAnnaHayley_01.png" alt=""> <img vspace="5" hspace="5" src="HotDogCode_KatyAnnaHayley_02.png" alt=""> <img vspace="5" hspace="5" src="HotDogCode_KatyAnnaHayley_03.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
clear
clc
close all
format compact

% Transport 3 Hot Dog Project Code
% for Katy Moran, Anna Hartig, and Hayley Semple

% list of material properties and design constraints with units. 
densityHotDog = 880;                                %[kg/m^3]
kHotDog = 0.52;                                     %[W/m-K]
cHotDog = 3350;                                     %[K/kg-K]
diameterHotDog = 0.0254;                            %[m]
radiusHotDog = diameterHotDog/2;                    %[m]

initialTemp = 15 + 273.15;                          %[K]
maxTs = 100 + 273.15;                               %[K]
finalTemp = 60 + 273.15;                            %[K]
gasTemp = 295 + 273.15;                             %[K]
coalsTemp = 425 + 273.15;                           %[K]
emissivityCoals = 0.8;                  
emissivityHotDog = 0.45;
diameterCoals = 0.045;                              %[m]

deltar = 0.0001; %**delta r** can be adjusted if needed %[m]
M = radiusHotDog/deltar;        
alphaHotDog = kHotDog/(densityHotDog*cHotDog);      %[m^2/s]

% calculating velocity of air
beta = 1/((coalsTemp + gasTemp)/2);
velocityAir = sqrt(9.81*beta*(coalsTemp - gasTemp)*diameterCoals);   %[m/s]

% % Calculating coefficients, h REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
% h rad calculation
hRad = 5;                                           %[W/m^2-K]

% h convec calculation
% calculating the air properties
TsurfaceHCalc = (initialTemp + gasTemp)/2;          %[K]
lowTemp = 400;                                      %[K]
highTemp = 450;                                     %[K]
nuLow = 26.41e-6;
nuHigh = 32.39e-6;
kAirLow = 33.8e-3;                                  %[W/m-K]
kAirHigh = 37.3e-3;                                 %[W/m-K]
PrLow = 0.690;
PrHigh = 0.686;

% interpolating the properties of air
nuFilm = nuLow + (TsurfaceHCalc - lowTemp)*(nuHigh-nuLow)/(highTemp-lowTemp);
kAirFilm = kAirLow + (TsurfaceHCalc - lowTemp)*(kAirHigh-kAirLow)/(highTemp-lowTemp);
PrFilm = PrLow + (TsurfaceHCalc - lowTemp)*(PrHigh-PrLow)/(highTemp-lowTemp);

Re = velocityAir*diameterHotDog / nuFilm;
C = 0.683;
mConst = 0.466;

Nu = C*Re^mConst*PrFilm^(1/3);

hConv = Nu*kAirFilm/diameterHotDog;

%total h
hTot = hRad + hConv;

% % numerical solution REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%stability criteria calculation for delta t
deltatSurface = (deltar^2 * M * kHotDog)/(alphaHotDog*(2*M*kHotDog - kHotDog + 2*hTot*M*deltar));
deltatCenter = (deltar^2)/(4*alphaHotDog);
deltatInterior = (deltar^2)/(2*alphaHotDog);

%choosing the smallest deltat based on stability criteria
if (deltatInterior < deltatSurface && deltatInterior < deltatCenter) 
    deltat = deltatInterior;
elseif deltatCenter < deltatSurface 
    deltat = deltatCenter;
else
    deltat = deltatSurface;
    fprintf('Surface Stability')
end

%Calculating Fo
Fo = (deltat*alphaHotDog)/deltar^2;

%initializing the matrices
temperature = zeros(20000, ceil(M)+1);
time=zeros(20000,1);
temperature(1,:) = initialTemp;

% loop until centerline Temp = 60 degrees
i=1;

while temperature(i,1) < finalTemp
    for j=1:ceil(M)+1 %loop through each radial node
        if j==1 %center node
            temperature(i+1,j) = 4*Fo*temperature(i, j+1) - (4*Fo-1)*temperature(i,j);
        elseif j==ceil(M)+1 %surface node
            temperature(i+1, j) = (1 - 2*Fo*(1-(1/(2*M))) - 2*(hTot/kHotDog)*Fo*deltar)*temperature(i,j) + ...
                2*Fo*(1-(1/(2*M)))*temperature(i, j-1) + 2*(hTot/kHotDog)*Fo*deltar*gasTemp;
        else %all other interior nodes
            temperature(i+1, j) = (1-2*Fo)*temperature(i,j) + Fo*(1-(1/(2*(j-1))))*temperature(i, j-1) + ...
                Fo*(1+(1/(2*(j-1))))*temperature(i, j+1);
        end
            
    end
    time(i+1) = deltat*i;
    i=i+1;
    
end

xmatrix = zeros(128,1); % creating the radius matrix for each node
for k=1:M+1
    xmatrix(k+1) = k*deltar;
end

%Plotting Numerical Solution (Temperature Distribution)
figure
plot(xmatrix, temperature(1,:), xmatrix, temperature(2118,:), xmatrix, temperature(8468,:), xmatrix, temperature(i,:));
title('Numerical Solution for Temperature Distribution at Specified Times');
xlabel('Radius, [m]')
ylabel('Temperature, [K]')
legend('t = 0 sec', 't = 30.0044 sec', 't = 120.0034 seconds', 't = 333.9319 seconds');
xlim([0, radiusHotDog])

% % Analytical solution REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-

Bi_Tab= [0,       0.01,    0.02,    0.04,    0.06,    0.08,    0.1,     0.15,    0.2,     0.3,     0.4,     0.5];    
Table=  [0,       0.1412,  0.1995,  0.2814,  0.3438,  0.396,   0.4417,  0.5376,  0.617,   0.7465,  0.8516,  0.9408; ...
         3.8317,  3.8343,  3.8369,  3.8421,  3.8473,  3.8525,  3.8577,  3.8706,  3.8835,  3.9091,  3.9344,  3.9594; ...
         7.0156,  7.017,   7.0184,  7.0213,  7.0241,  7.027,   7.0298,  7.0369,  7.044,   7.0582,  7.0723,  7.0864; ...
         10.1735, 10.1745, 10.1754, 10.1774, 10.1794, 10.1813, 10.1833, 10.1882, 10.1931, 10.2029, 10.2127, 10.2225;...
         13.3237, 13.3244, 13.3252, 13.3267, 13.3282, 13.3297, 13.3312, 13.3349, 13.3387, 13.3462, 13.3537, 13.3611;...
         16.4706, 16.4712, 16.4718, 16.4731, 16.4743, 16.4755, 14.4767, 16.4797, 16.4828, 16.4888, 16.4949, 16.501];

p = 1;
theta = zeros(3025, ceil(M)+1);
temp = zeros(3025, ceil(M)+1);
time_a=zeros(3025,1);
temp(1, :) = initialTemp;
Bi = hTot*(radiusHotDog)/kHotDog;

%interpolating from table!
if Bi == 0
    squiggle = Table(:,1);
elseif Bi>0 && Bi<0.01
    squiggle = Table(:,2)-((0.01-Bi)./((0.01-0)./(Table(:,2)-Table(:,1))));
elseif Bi == 0.01
    squiggle = Table(:,2);
elseif Bi>0.01 && Bi<0.02
    squiggle = Table(:,3)-((0.02-Bi)./((0.02-0.01)./(Table(:,3)-Table(:,2))));
elseif Bi == 0.02
    squiggle = Table(:,3);
elseif Bi>0.02 && Bi<0.04
    squiggle = Table(:,4)-((0.04-Bi)./((0.04-0.02)./(Table(:,4)-Table(:,3))));
elseif Bi == 0.04
    squiggle = Table(:,4);
elseif Bi>0.04 && Bi<0.06
    squiggle = Table(:,5)-((0.06-Bi)./((0.06-0.04)./(Table(:,5)-Table(:,4))));
elseif Bi == 0.06
    squiggle = Table(:,5);
elseif Bi>0.06 && Bi<0.08
    squiggle = Table(:,6)-((0.08-Bi)./((0.08-0.06)./(Table(:,6)-Table(:,5))));
elseif Bi == 0.08
    squiggle = Table(:,6);
elseif Bi>0.08 && Bi<0.1
    squiggle = Table(:,7)-((0.1-Bi)./((0.1-0.08)./(Table(:,7)-Table(:,6))));
elseif Bi == 0.1
    squiggle = Table(:,7);
elseif Bi>0.1 && Bi<0.15
    squiggle = Table(:,8)-((0.15-Bi)./((0.15-0.1)./(Table(:,8)-Table(:,7))));
elseif Bi == 0.15
    squiggle = Table(:,8);
elseif Bi>0.15 && Bi<0.2
    squiggle = Table(:,9)-((0.2-Bi)./((0.2-0.15)./(Table(:,9)-Table(:,8))));
elseif Bi == 0.2
    squiggle = Table(:,9);
elseif Bi>0.2 && Bi<0.3
    squiggle = Table(:,10)-((0.3-Bi)./((0.3-0.2)./(Table(:,10)-Table(:,9))));
elseif Bi == 0.3
    squiggle = Table(:,10);
elseif Bi>0.3 && Bi<0.4
    squiggle = Table(:,11)-((0.4-Bi)./((0.4-0.3)./(Table(:,11)-Table(:,10))));
elseif Bi == 0.4
    squiggle = Table(:,11);
elseif Bi>0.4 && Bi<0.5
    squiggle = Table(:,12)-((0.5-Bi)./((0.5-0.4)./(Table(:,12)-Table(:,11))));
else %Bi == 0.5
    squiggle = Table(:,12);
end

%determining temp at different times and various positions(vary based on
%analytical solution)
while temp(p,1) < finalTemp
    for q=1:ceil(M)+1
        time_a(p+1) = time_a(p) + 0.1;
        %Calculating Fo
        fo = (time_a(p+1)*alphaHotDog)./(radiusHotDog.^2);
        
        %calculating each nth term
        term1 = ((2/squiggle(1)) * besselj(1,squiggle(1)) / ...
            (((besselj(0,squiggle(1)))^2)+((besselj(1,squiggle(1)))^2)))* ...
            exp(-(squiggle(1)^2)*fo)*besselj(0,(squiggle(1)*(q-1)*deltar/radiusHotDog));
        term2 = ((2/squiggle(2)) * besselj(1,squiggle(2)) / ...
            (((besselj(0,squiggle(2)))^2)+((besselj(1,squiggle(2)))^2)))* ...
            exp(-(squiggle(2)^2)*fo)*besselj(0,(squiggle(2)*(q-1)*deltar/radiusHotDog));
        term3 = ((2/squiggle(3)) * besselj(1,squiggle(3)) / ...
            (((besselj(0,squiggle(3)))^2)+((besselj(1,squiggle(3)))^2)))* ...
            exp(-(squiggle(3)^2)*fo)*besselj(0,(squiggle(3)*(q-1)*deltar/radiusHotDog));
        term4 = ((2/squiggle(4)) * besselj(1,squiggle(4)) / ...
            (((besselj(0,squiggle(4)))^2)+((besselj(1,squiggle(4)))^2)))* ...
            exp(-(squiggle(4)^2)*fo)*besselj(0,(squiggle(4)*(q-1)*deltar/radiusHotDog));
        term5 = ((2/squiggle(5)) * besselj(1,squiggle(5)) / ...
            (((besselj(0,squiggle(5)))^2)+((besselj(1,squiggle(5)))^2)))* ...
            exp(-(squiggle(5)^2)*fo)*besselj(0,(squiggle(5)*(q-1)*deltar/radiusHotDog));
        term6 = ((2/squiggle(6)) * besselj(1,squiggle(6)) / ...
            (((besselj(0,squiggle(6)))^2)+((besselj(1,squiggle(6)))^2)))* ...
            exp(-(squiggle(6)^2)*fo)*besselj(0,(squiggle(6)*(q-1)*deltar/radiusHotDog));
        
        %summing all the terms
        theta(p+1,q) = term1 + term2 + term3 + term4 + term5 + term6;
        
        %calculating temperature
        temp(p+1,q) = theta(p+1,q) .* (initialTemp - gasTemp) + gasTemp;
        
    end
    
    p=p+1;
    
end

%Plotting Centerline/Exterior Solution
figure
plot(time_a, temp(:,1), 'b' , time_a, temp(:,128), 'r',  time, temperature(:,1), 'REPLACE_WITH_DASH_DASHb', time, temperature(:,128), 'REPLACE_WITH_DASH_DASHr');
title('Hot Dog Temperature History');
xlabel('time, [seconds]')
ylabel('Temperature, [K]')
legend('Centerline, Analytical', 'Exterior, Analytical', 'Centerline, Numerical', 'Exterior, Numerical');
xlim([0, 335])

%Plotting Analytical Solution (Temperature Distribution)
figure
plot(xmatrix, temp(1,:), xmatrix, temp(301,:), xmatrix, temp(1201,:), xmatrix, temp(p,:));
title('Analytical Solution for Temperature Distribution at Specified Times');
xlabel('Radius, [m]')
ylabel('Temperature, [K]')
legend('t = 0 sec', 't = 30 sec', 't = 120 seconds', 't = 334.14 seconds');
xlim([0, radiusHotDog])

##### SOURCE END #####
--></body></html>